---
title: "Data Story: Classical Music "
---

Question: How well-liked is classical music today? 

# DataSet. Source: Kaggle

**Introduction: Why is this important?**

Percentage Audience for Music Genre

```{r, out.height= "800px",out.width= "700px",echo=FALSE,eval=TRUE}

knitr::include_graphics("dataset for listening.png") 
```

The average percentage of audience remains constant at 1% across many different years from 2017 to  2021. This is an intriguing fact - that *it is a low percentage and a steady, unchanging percentage* striked me as curious. I wondered if this percentage is still reflective of today, and if the popularity of classical music would change in the future. 
Some argue that classical music is timeless and will continue to stand the test of time - just like it has currently. On the contrary, some argue that classical music is "dying" because of the following factors:

#1 Realistically, less and less people listen each year per capita and even opera houses are kept open by public funding and private donations instead of sales. With lack of sufficient support from governments and lowered interest, it seems inevitable that classical music will fall out of favor. 

#2 Classical music is no longer the same genre as it was - currently it is only comprised and recognised for pieces by the most prominent, superstar composers like Beethoven. There are still classical pieces made currently, but these pieces often go unnoticed and receive no recognition.


#3 Classical music competes head-on with modern music - which is evolving and changing all the time. Furthermore, as music becomes more experimentally and its form expands, it appears that current popular music could not deviate further from classical music. 

```{r, eval=TRUE,echo=F, message=FALSE, warning=FALSE}
library(tidyverse)
library(randomForest)
library(dplyr)
library(GGally)
```

```{r, eval=TRUE,echo=F}

target<- c("['Robert Schumann', 'Vladimir Horowitz']","['Franz Joseph Haydn', 'Pro Arte Quartet']","['Felix Mendelssohn', 'Vladimir Horowitz']", "['Frédéric Chopin', 'Vladimir Horowitz']", "['Franz Liszt', 'Vladimir Horowitz']","['Sergei Rachmaninoff', 'Vladimir Horowitz']", "['Ludwig van Beethoven', 'Staatskapelle Berlin', 'Richard Strauss']")
spotifydata<-read.csv("spotify-data.csv")
updateddata<- spotifydata %>%
  select(name,artists, year,danceability, energy, popularity,valence)%>%
  filter(artists%in%target) %>%
  filter(popularity >= 1) %>%
  arrange(year)
```

```{r, eval=TRUE,echo=F}
avgdata<- updateddata %>%
  group_by(year)%>%
  reframe(summ = ave(popularity))
```

**Popularity of Music Over Time**
```{r, eval=TRUE,echo=F}
ggplot(data=avgdata) +
  aes( x=year, y=summ) +
  geom_point() +
  geom_line() + 
  labs( x= "Year", y = "Average Popularity", title="Average Popularity Of Classical Pieces Over Time",
caption = 
"Based on this graph, there is an overall significant increase in average popularity of classical pieces over time.
However, this increase is volatile as seen in the random decrease in average popularity in certain years.
Nonetheless, the popularity of classical pieces seems to be stabilising as each drop and increase in average popularity is less
drastic. This suggests that classical music is becoming increasingly well-liked.")
```


**What *Types* Of Classical Music Is Well-liked?**

#1. Energy

```{r, eval=TRUE,echo=F}
ggplot(data=updateddata) +
  aes(x=energy, y= popularity) +
  geom_point() + 
  geom_line() +
  labs(x= "Energy Levels", y="Popularity", title="Energy Levels And Popularity Of Pieces", 
       caption= "As seen in the graph, classical music pieces are usually more popular if they are less intense and active. 
       However, we also note that the data points is most dense close to the bottom left of the graph. 
       This reveals that majority of the data points have low energy levels and usually received similarly by the audience. ")
```


2. Danceability

```{r, eval=TRUE,echo=F}
ggplot(data=updateddata) +
  aes(x=danceability, y=popularity) +
  geom_point() +
  labs(x= "Danceability", y = "Popularity", title="Danceability And Popularity Of Pieces",
       caption = "In general, as seen in the even spread of data, all types of classical music with different liveliness (as defined in the variable 
       danceability) does not affect the popularity of classical music. 
       This suggests that to the public audience, both danceable and lively pieces of classical music are well-liked.")  
```

3. Valence

```{r, eval=TRUE,echo=F}
ggplot(data=updateddata) +
  aes(x=valence, y=popularity) +
  geom_point() +
  labs(x= "Valence", y = "Popularity", title="Valence And Its Popularity",
       caption = "As seen in the scatter plot, classical music is significantly more popular when it has lower valence with a score of below \n 0.5. This suggests that classical music which are happier and more upbeat is more well-liked among the audience rather than \n pieces which are more somber and sad.")
```

Classical Music In The Future 

```{r, eval=TRUE,echo=F}

ggpairs(data=avgdata, columns=1:2, title="Average popularity rating and years")
```

As seen in the graphs above, the high r-value of 0.771 suggests that average popularity rating and years have a strong positive linear correlation. Hence, it is appropriate to use this dataset to create a prediction model that can reflect the popularity rating of the dataset in the following years. 

```{=html}
<iframe height="600" width="100%" frameborder="no" src="https://claralclaroll.shinyapps.io/App-1/  "> </iframe>
```


**Limitations**

#1 Reliability of Datasets
While the dataset I used can be used to predict the popularity of classical music in the future. It is still ultimately a dataset made for years that are outside of the data range of the original dataset. This affects the reliability of the data and the conclusions that I have made. The graph below shows the extent to which the linear regression model I have made is valid as the shaded area visualises its confidence interval.

```{r, eval=TRUE,echo=F, warning=FALSE, message=FALSE}
ggplot(data = avgdata, aes(x= year, y= summ))+
  geom_point()+ 
  geom_smooth(method = "lm", col ="pink") + 
  theme(panel.background = element_rect(fill = "white"),
        axis.line.x=element_line(),
        axis.line.y=element_line()) +
  ggtitle("Linear Model Fitted to Data")

``` 

#2 Classical Music Is Constantly Evolving

The dataset I have tided for analysis is from an larger dataset. My decision to pick out only the most prominent classical composers and musicians narrows the scope to which the findings from this analysis can apply to. Therefore, it may not be sufficient to reflect the genre of "classical music". Additionally, music classified under classical music is constantly evolving and changing over time. Hence, it would be very easy for the observations made and the dataset gathered to become obselete. 


**Conclusions**
